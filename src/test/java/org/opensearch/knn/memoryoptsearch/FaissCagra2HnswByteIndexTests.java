/*
 * Copyright OpenSearch Contributors
 * SPDX-License-Identifier: Apache-2.0
 */

package org.opensearch.knn.memoryoptsearch;

import org.opensearch.knn.index.KNNVectorSimilarityFunction;
import org.opensearch.knn.index.VectorDataType;

public class FaissCagra2HnswByteIndexTests extends AbstractFaissCagraHnswIndexTests {

    public void testKNNSearchByte() {
        // Exhaustive search test
        doTestKNNSearch(true, VectorDataType.BYTE, KNNVectorSimilarityFunction.MAXIMUM_INNER_PRODUCT);

        // ANN search test
        doTestKNNSearch(false, VectorDataType.BYTE, KNNVectorSimilarityFunction.MAXIMUM_INNER_PRODUCT);
    }

    public void testLoadVectors() {
        doTestLoadVectors(VectorDataType.BYTE, FIRST_VECTOR, LAST_VECTOR);
    }

    @Override
    protected String getBinaryDataRelativePath() {
        return "data/memoryoptsearch/faiss_cagra2_flat_byte_300_vectors_768_dims.bin";
    }

    private static final byte[] FIRST_VECTOR = new byte[] {
        -3,
        1,
        -4,
        0,
        -2,
        0,
        6,
        -3,
        0,
        7,
        -2,
        -3,
        5,
        4,
        -2,
        0,
        6,
        3,
        0,
        -2,
        -3,
        4,
        0,
        -3,
        -2,
        3,
        -2,
        4,
        -1,
        0,
        1,
        0,
        -5,
        5,
        -8,
        4,
        0,
        4,
        7,
        4,
        -3,
        2,
        5,
        0,
        4,
        4,
        1,
        1,
        2,
        1,
        -5,
        0,
        -7,
        0,
        -5,
        7,
        1,
        6,
        5,
        2,
        1,
        -3,
        -2,
        -2,
        0,
        3,
        -2,
        6,
        2,
        2,
        1,
        -1,
        1,
        -3,
        -5,
        -1,
        0,
        1,
        5,
        -6,
        4,
        0,
        1,
        5,
        2,
        2,
        0,
        0,
        1,
        4,
        1,
        3,
        1,
        -1,
        2,
        -2,
        1,
        -4,
        0,
        -2,
        3,
        -3,
        -3,
        2,
        1,
        -4,
        -9,
        0,
        0,
        0,
        7,
        1,
        1,
        -5,
        0,
        -2,
        2,
        -2,
        -2,
        -13,
        1,
        3,
        -2,
        -10,
        3,
        -10,
        4,
        -1,
        8,
        5,
        2,
        -1,
        2,
        4,
        0,
        4,
        2,
        -1,
        1,
        -5,
        -2,
        0,
        0,
        5,
        -3,
        -1,
        -1,
        2,
        0,
        0,
        3,
        3,
        2,
        2,
        -4,
        -1,
        5,
        2,
        4,
        -3,
        8,
        2,
        -1,
        5,
        -5,
        -2,
        1,
        2,
        4,
        -5,
        -4,
        4,
        3,
        0,
        3,
        0,
        1,
        0,
        4,
        1,
        -2,
        -3,
        1,
        6,
        7,
        1,
        1,
        1,
        -6,
        4,
        0,
        1,
        9,
        0,
        -3,
        -4,
        -1,
        4,
        -1,
        2,
        2,
        -1,
        0,
        2,
        4,
        -7,
        0,
        -1,
        -1,
        -3,
        0,
        1,
        0,
        4,
        -2,
        3,
        0,
        0,
        3,
        -2,
        -4,
        0,
        -3,
        2,
        1,
        -7,
        -3,
        0,
        1,
        1,
        3,
        1,
        3,
        -4,
        -1,
        3,
        1,
        5,
        0,
        0,
        6,
        0,
        -3,
        0,
        5,
        0,
        3,
        -2,
        -4,
        1,
        0,
        1,
        5,
        4,
        -3,
        2,
        4,
        2,
        1,
        -2,
        3,
        0,
        6,
        0,
        -1,
        1,
        5,
        2,
        3,
        -2,
        1,
        -1,
        -4,
        5,
        0,
        0,
        5,
        5,
        -7,
        2,
        1,
        4,
        -1,
        0,
        1,
        2,
        0,
        -2,
        -7,
        -1,
        0,
        5,
        -3,
        -2,
        2,
        1,
        0,
        1,
        -2,
        -5,
        5,
        -5,
        3,
        4,
        -1,
        0,
        0,
        7,
        0,
        3,
        7,
        -9,
        -5,
        5,
        1,
        7,
        1,
        -1,
        4,
        3,
        0,
        -1,
        -4,
        3,
        2,
        -3,
        0,
        0,
        -4,
        2,
        3,
        7,
        -5,
        -5,
        -3,
        2,
        0,
        5,
        0,
        -2,
        3,
        1,
        3,
        1,
        -4,
        1,
        2,
        -3,
        -1,
        -3,
        7,
        -6,
        -1,
        0,
        0,
        1,
        8,
        0,
        1,
        -3,
        2,
        6,
        0,
        -1,
        2,
        1,
        5,
        -4,
        5,
        0,
        2,
        0,
        0,
        -1,
        -1,
        -1,
        -3,
        4,
        6,
        0,
        2,
        7,
        -2,
        4,
        -3,
        -2,
        0,
        3,
        4,
        6,
        1,
        -2,
        1,
        -5,
        0,
        1,
        -3,
        0,
        0,
        -1,
        0,
        6,
        1,
        4,
        42,
        2,
        1,
        -1,
        0,
        -7,
        -3,
        -6,
        0,
        0,
        -2,
        1,
        1,
        5,
        1,
        0,
        8,
        -4,
        -1,
        3,
        0,
        3,
        3,
        2,
        1,
        6,
        -3,
        2,
        5,
        4,
        7,
        0,
        2,
        -2,
        2,
        -1,
        1,
        3,
        8,
        1,
        -1,
        -1,
        2,
        5,
        3,
        -5,
        -5,
        5,
        1,
        1,
        7,
        4,
        -3,
        -1,
        0,
        5,
        4,
        -1,
        7,
        3,
        -8,
        -2,
        1,
        -1,
        -7,
        4,
        -1,
        6,
        3,
        2,
        1,
        3,
        9,
        -1,
        0,
        -1,
        -1,
        2,
        0,
        0,
        4,
        1,
        0,
        0,
        0,
        6,
        3,
        -1,
        6,
        4,
        0,
        -3,
        0,
        -3,
        4,
        2,
        1,
        -36,
        2,
        6,
        0,
        0,
        -1,
        0,
        -3,
        0,
        3,
        0,
        2,
        1,
        2,
        -2,
        4,
        5,
        2,
        4,
        -1,
        0,
        6,
        1,
        -1,
        0,
        1,
        -3,
        -7,
        1,
        1,
        -5,
        3,
        6,
        0,
        2,
        -3,
        2,
        1,
        2,
        0,
        0,
        -1,
        6,
        1,
        2,
        -1,
        1,
        1,
        2,
        -1,
        5,
        3,
        -2,
        2,
        4,
        -3,
        7,
        0,
        -3,
        3,
        0,
        2,
        0,
        0,
        3,
        0,
        0,
        2,
        3,
        2,
        6,
        1,
        0,
        0,
        5,
        -1,
        -3,
        -4,
        5,
        3,
        -1,
        -1,
        -4,
        1,
        26,
        0,
        22,
        1,
        0,
        4,
        1,
        3,
        0,
        1,
        -3,
        -3,
        -2,
        3,
        -5,
        -1,
        3,
        -9,
        0,
        1,
        5,
        -3,
        -1,
        0,
        6,
        -1,
        3,
        -1,
        -2,
        -2,
        1,
        -4,
        3,
        -3,
        -1,
        2,
        0,
        43,
        6,
        1,
        -2,
        2,
        -3,
        4,
        -1,
        -1,
        3,
        2,
        0,
        2,
        1,
        2,
        2,
        8,
        5,
        4,
        0,
        1,
        2,
        2,
        0,
        3,
        4,
        6,
        -1,
        0,
        9,
        9,
        50,
        4,
        1,
        0,
        3,
        5,
        0,
        0,
        -1,
        0,
        1,
        5,
        -4,
        -2,
        2,
        0,
        -2,
        0,
        0,
        -2,
        2,
        2,
        -1,
        -1,
        0,
        -4,
        -1,
        5,
        1,
        1,
        4,
        2,
        -2,
        5,
        -2,
        2,
        -1,
        0,
        2,
        -3,
        3,
        2,
        -3,
        -6,
        3,
        6,
        -2,
        0,
        1,
        0,
        2,
        2,
        8,
        -5,
        -2,
        0,
        4,
        2,
        -1,
        -4,
        8,
        3,
        1,
        7,
        0,
        2,
        2,
        2,
        7,
        0,
        -1,
        -1,
        0,
        2,
        1,
        0,
        -1,
        -1,
        -2,
        4,
        -1,
        -3,
        -3,
        0,
        -3,
        0,
        0,
        -1,
        4,
        0,
        1,
        0,
        -4,
        6,
        -1,
        -4,
        5,
        0,
        0,
        1,
        -2,
        2,
        -1,
        -1,
        0,
        -4,
        4,
        0,
        4,
        2,
        4,
        4,
        0,
        -1,
        0, };
    private static final byte[] LAST_VECTOR = new byte[] {
        0,
        3,
        0,
        -1,
        0,
        0,
        3,
        -5,
        0,
        5,
        -5,
        0,
        1,
        7,
        -1,
        3,
        4,
        3,
        0,
        1,
        0,
        3,
        0,
        -2,
        -2,
        3,
        -3,
        2,
        1,
        -1,
        2,
        -1,
        0,
        5,
        -3,
        4,
        -2,
        2,
        0,
        3,
        0,
        2,
        0,
        1,
        5,
        0,
        0,
        2,
        4,
        0,
        -2,
        -2,
        -3,
        0,
        -2,
        3,
        -4,
        3,
        1,
        2,
        2,
        0,
        -1,
        -1,
        3,
        2,
        0,
        1,
        2,
        0,
        2,
        5,
        -1,
        3,
        2,
        -3,
        -1,
        4,
        3,
        0,
        5,
        0,
        -5,
        1,
        3,
        3,
        -1,
        4,
        0,
        5,
        0,
        1,
        0,
        -1,
        0,
        -1,
        2,
        -5,
        -1,
        -4,
        0,
        -2,
        -3,
        4,
        1,
        -3,
        -6,
        1,
        2,
        1,
        3,
        -3,
        -2,
        3,
        1,
        0,
        0,
        -1,
        0,
        -10,
        4,
        2,
        -2,
        -3,
        0,
        -3,
        6,
        -1,
        5,
        1,
        1,
        0,
        0,
        6,
        2,
        7,
        2,
        -2,
        2,
        -3,
        0,
        -2,
        2,
        7,
        -4,
        1,
        0,
        3,
        0,
        3,
        3,
        -1,
        1,
        3,
        -1,
        0,
        3,
        0,
        7,
        -2,
        8,
        3,
        1,
        5,
        0,
        -2,
        2,
        3,
        5,
        -2,
        0,
        6,
        6,
        0,
        1,
        1,
        0,
        -1,
        4,
        6,
        0,
        -1,
        2,
        0,
        6,
        5,
        5,
        -2,
        -2,
        0,
        0,
        1,
        7,
        1,
        -2,
        0,
        -5,
        4,
        -1,
        4,
        3,
        -1,
        -1,
        2,
        2,
        -4,
        1,
        0,
        -1,
        -1,
        1,
        1,
        0,
        0,
        -1,
        3,
        -1,
        0,
        4,
        -1,
        -4,
        8,
        0,
        -2,
        1,
        -5,
        -1,
        -7,
        0,
        2,
        4,
        0,
        -1,
        -3,
        0,
        4,
        4,
        5,
        -3,
        0,
        3,
        0,
        -5,
        0,
        5,
        -5,
        6,
        -2,
        -2,
        -1,
        2,
        3,
        5,
        -1,
        0,
        1,
        0,
        0,
        4,
        0,
        1,
        0,
        4,
        2,
        0,
        0,
        5,
        3,
        2,
        6,
        2,
        -2,
        -1,
        0,
        0,
        0,
        -2,
        2,
        -4,
        -1,
        1,
        1,
        -3,
        1,
        3,
        3,
        0,
        0,
        -5,
        -3,
        2,
        5,
        0,
        -3,
        3,
        2,
        0,
        -1,
        -2,
        -1,
        8,
        -1,
        2,
        0,
        0,
        -1,
        0,
        2,
        0,
        0,
        3,
        -5,
        -5,
        9,
        1,
        5,
        2,
        0,
        7,
        -1,
        -3,
        -5,
        -5,
        2,
        0,
        -4,
        0,
        0,
        -2,
        -4,
        3,
        2,
        -2,
        -3,
        0,
        1,
        3,
        2,
        -1,
        0,
        2,
        -1,
        -1,
        1,
        -2,
        2,
        2,
        1,
        4,
        -1,
        5,
        0,
        -1,
        1,
        7,
        1,
        4,
        1,
        2,
        -2,
        1,
        7,
        3,
        0,
        4,
        -2,
        6,
        -1,
        3,
        4,
        1,
        0,
        -1,
        0,
        -2,
        2,
        -3,
        4,
        6,
        -2,
        -2,
        7,
        0,
        0,
        -1,
        -4,
        -1,
        -2,
        -1,
        -2,
        2,
        -1,
        -3,
        -2,
        -4,
        1,
        1,
        2,
        4,
        -2,
        -2,
        6,
        1,
        2,
        45,
        0,
        0,
        1,
        0,
        2,
        2,
        0,
        -1,
        -2,
        1,
        -1,
        0,
        2,
        0,
        -1,
        0,
        2,
        0,
        1,
        -3,
        4,
        4,
        5,
        5,
        5,
        1,
        3,
        6,
        6,
        1,
        2,
        2,
        0,
        0,
        4,
        3,
        1,
        5,
        3,
        -1,
        0,
        4,
        3,
        3,
        -2,
        -1,
        5,
        1,
        4,
        0,
        3,
        -2,
        0,
        -1,
        5,
        4,
        0,
        0,
        0,
        0,
        2,
        3,
        -1,
        -5,
        2,
        -4,
        2,
        0,
        -5,
        3,
        4,
        -1,
        -2,
        -2,
        0,
        0,
        1,
        2,
        0,
        3,
        0,
        0,
        0,
        -4,
        4,
        5,
        2,
        5,
        0,
        3,
        2,
        5,
        4,
        3,
        2,
        1,
        -38,
        2,
        4,
        0,
        0,
        -1,
        2,
        2,
        0,
        0,
        -1,
        -1,
        -1,
        1,
        -1,
        0,
        0,
        2,
        4,
        -1,
        1,
        6,
        2,
        -1,
        2,
        3,
        -1,
        -3,
        -1,
        2,
        -2,
        3,
        4,
        -3,
        2,
        -1,
        4,
        0,
        0,
        4,
        -1,
        2,
        1,
        0,
        0,
        2,
        1,
        1,
        2,
        -1,
        -1,
        0,
        -3,
        1,
        4,
        -3,
        2,
        0,
        -1,
        3,
        0,
        2,
        3,
        1,
        2,
        0,
        -3,
        -1,
        0,
        0,
        7,
        -1,
        0,
        -1,
        5,
        4,
        -2,
        0,
        2,
        0,
        0,
        -1,
        -5,
        -1,
        22,
        0,
        22,
        6,
        0,
        2,
        -1,
        0,
        1,
        1,
        -1,
        6,
        0,
        0,
        -4,
        -1,
        3,
        -7,
        0,
        0,
        0,
        0,
        2,
        1,
        4,
        0,
        2,
        -2,
        0,
        -1,
        1,
        1,
        2,
        2,
        -2,
        1,
        1,
        45,
        -4,
        0,
        -2,
        0,
        0,
        3,
        0,
        0,
        1,
        7,
        1,
        0,
        0,
        4,
        1,
        1,
        4,
        0,
        0,
        1,
        -4,
        6,
        -3,
        0,
        6,
        6,
        0,
        0,
        3,
        2,
        52,
        -1,
        0,
        0,
        1,
        3,
        2,
        0,
        -2,
        0,
        0,
        4,
        -2,
        0,
        0,
        1,
        -3,
        2,
        3,
        -1,
        3,
        0,
        0,
        1,
        0,
        -1,
        -1,
        1,
        1,
        1,
        1,
        4,
        -3,
        2,
        -2,
        0,
        -2,
        0,
        2,
        0,
        3,
        0,
        -2,
        -7,
        1,
        4,
        0,
        -3,
        1,
        4,
        0,
        0,
        10,
        -4,
        -1,
        1,
        1,
        -2,
        -6,
        0,
        7,
        2,
        0,
        3,
        2,
        2,
        -2,
        0,
        4,
        -4,
        -4,
        1,
        -1,
        1,
        -3,
        0,
        1,
        0,
        3,
        2,
        0,
        0,
        0,
        5,
        -1,
        3,
        -4,
        -2,
        8,
        0,
        1,
        -4,
        -3,
        1,
        2,
        -2,
        3,
        -1,
        3,
        2,
        -4,
        5,
        -1,
        -3,
        0,
        -3,
        2,
        -2,
        0,
        2,
        5,
        3,
        0,
        -2,
        2, };
}
