/*
 * Copyright OpenSearch Contributors
 * SPDX-License-Identifier: Apache-2.0
 */

package org.opensearch.knn.memoryoptsearch;

import lombok.SneakyThrows;
import org.apache.lucene.index.FloatVectorValues;
import org.apache.lucene.index.VectorSimilarityFunction;
import org.apache.lucene.search.KnnCollector;
import org.apache.lucene.search.ScoreDoc;
import org.apache.lucene.search.TopDocs;
import org.apache.lucene.search.TopKnnCollector;
import org.apache.lucene.store.IndexInput;
import org.apache.lucene.util.IOConsumer;
import org.opensearch.knn.KNNTestCase;
import org.opensearch.knn.memoryoptsearch.faiss.FaissIndex;
import org.opensearch.knn.memoryoptsearch.faiss.FaissMemoryOptimizedSearcher;

import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.concurrent.ThreadLocalRandom;
import java.util.stream.Collectors;

import static org.opensearch.knn.memoryoptsearch.FaissHNSWTests.loadHnswBinary;

public class FaissCagraHnswIndexTests extends KNNTestCase {
    private static final int EF_SEARCH = 100;
    private static final int DIMENSION = 768;
    private static final int TOTAL_NUMBER_OF_VECTORS = 300;

    public void testKNNSearch() {
        // Exhaustive search test
        doTestKNNSearch(true);

        // ANN search test
        doTestKNNSearch(false);
    }

    public void doTestKNNSearch(boolean isApproximateSearch) {
        doTestWithIndexInput(input -> {
            // Instantiate memory optimized searcher
            final FaissMemoryOptimizedSearcher searcher = new FaissMemoryOptimizedSearcher(input);

            // Make collector
            final int k = isApproximateSearch ? EF_SEARCH : TOTAL_NUMBER_OF_VECTORS;
            final KnnCollector knnCollector = new TopKnnCollector(k, Integer.MAX_VALUE);

            // Build a query
            final float[] query = new float[DIMENSION];
            for (int i = 0; i < query.length; i++) {
                query[i] = ThreadLocalRandom.current().nextFloat();
            }

            // Start searching
            searcher.search(query, knnCollector, null);
            final TopDocs topDocs = knnCollector.topDocs();
            final ScoreDoc[] scoreDocs = topDocs.scoreDocs;

            // Get answer
            input.seek(0);
            final FaissIndex faissIndex = FaissIndex.load(input);
            final Set<Integer> answerScoreDocs = calculateAnswer(query, faissIndex.getFloatValues(input), k);

            // Validate search result
            int matchCount = 0;
            for (ScoreDoc sd : scoreDocs) {
                if (answerScoreDocs.contains(sd.doc)) {
                    ++matchCount;
                }
            }
            final float matchRatio = (float) matchCount / (float) k;
            assertTrue(matchRatio > 0.8);
        });
    }

    @SneakyThrows
    private Set<Integer> calculateAnswer(final float[] query, final FloatVectorValues values, final int k) {
        final List<ScoreDoc> scoreDocs = new ArrayList<>();
        for (int i = 0; i < TOTAL_NUMBER_OF_VECTORS; ++i) {
            final float[] vector = values.vectorValue(i);
            scoreDocs.add(new ScoreDoc(i, VectorSimilarityFunction.EUCLIDEAN.compare(query, vector)));
        }
        scoreDocs.sort((s1, s2) -> -Float.compare(s1.score, s2.score));
        return scoreDocs.subList(0, k).stream().mapToInt(s -> s.doc).boxed().collect(Collectors.toSet());
    }

    public void testLoadVectors() {
        doTestWithIndexInput(input -> {
            final FaissIndex faissIndex = FaissIndex.load(input);
            final FloatVectorValues values = faissIndex.getFloatValues(input);

            // Validate the first vector
            float[] vector = values.vectorValue(0);
            assertArrayEquals(FIRST_VECTOR, vector, 1e-3f);

            // Validate the last vector
            vector = values.vectorValue(TOTAL_NUMBER_OF_VECTORS - 1);
            assertArrayEquals(LAST_VECTOR, vector, 1e-3f);
        });
    }

    @SneakyThrows
    private void doTestWithIndexInput(IOConsumer<IndexInput> indexInputConsumer) {
        final IndexInput input = loadHnswBinary("data/memoryoptsearch/faiss_cagra_flat_float_300_vectors_768_dims.bin");
        indexInputConsumer.accept(input);
    }

    private static final float[] FIRST_VECTOR = new float[] {
        0.407537f,
        0.204491f,
        0.772161f,
        -0.455525f,
        -0.019892f,
        0.658758f,
        0.5233f,
        -0.246101f,
        -0.105992f,
        0.337968f,
        -0.642836f,
        -0.0378031f,
        -0.0587838f,
        0.318792f,
        -0.188972f,
        0.0793116f,
        0.681344f,
        0.397058f,
        -0.388734f,
        -0.338713f,
        -0.589523f,
        0.907979f,
        -0.0491111f,
        -0.214506f,
        0.0332398f,
        0.000731098f,
        -0.568052f,
        0.113452f,
        -0.139367f,
        0.668956f,
        0.555129f,
        -0.121629f,
        -0.197233f,
        0.262861f,
        -0.29496f,
        0.421919f,
        -0.0640919f,
        0.995337f,
        0.443124f,
        0.205258f,
        -0.383587f,
        0.0170618f,
        0.748707f,
        0.00362182f,
        0.399577f,
        0.394889f,
        0.50295f,
        -0.482422f,
        0.423262f,
        0.353652f,
        -0.42878f,
        -0.273918f,
        0.244148f,
        -0.377878f,
        -0.463252f,
        -0.0699887f,
        0.0859836f,
        0.205032f,
        0.738489f,
        -0.0214788f,
        -0.0321641f,
        -0.043467f,
        -0.397826f,
        -0.105037f,
        -0.402929f,
        0.307924f,
        0.325186f,
        0.74841f,
        0.263975f,
        0.012814f,
        -0.0465779f,
        0.00300349f,
        0.00965591f,
        -0.106873f,
        -0.204605f,
        -0.4796f,
        0.336507f,
        -0.31191f,
        0.203268f,
        -0.0370436f,
        0.907404f,
        0.171605f,
        -0.547958f,
        0.194997f,
        0.132402f,
        0.612407f,
        -0.272758f,
        0.52806f,
        -0.136788f,
        0.0560072f,
        -0.354249f,
        0.557712f,
        0.218548f,
        0.144902f,
        -0.221636f,
        -0.704499f,
        0.157626f,
        -0.133767f,
        0.0119683f,
        -0.694727f,
        -0.0473542f,
        -0.292864f,
        -1.09094f,
        -0.199107f,
        0.0935866f,
        -0.308377f,
        -0.371356f,
        -0.197738f,
        -0.043471f,
        0.816441f,
        0.330888f,
        -0.702139f,
        -0.243415f,
        0.556931f,
        0.553833f,
        -0.0230115f,
        0.0515396f,
        0.0952602f,
        0.164712f,
        -1.18274f,
        0.495534f,
        0.803497f,
        -0.33648f,
        0.0736255f,
        0.187068f,
        -0.10972f,
        0.537644f,
        -0.315559f,
        0.53308f,
        0.360017f,
        0.0496401f,
        -0.248086f,
        0.0437046f,
        0.768494f,
        -0.245209f,
        0.722299f,
        -0.103285f,
        0.409579f,
        -0.426734f,
        -0.0409273f,
        -0.449258f,
        0.40331f,
        0.847415f,
        0.375476f,
        -0.237951f,
        0.0347316f,
        0.0457192f,
        0.775461f,
        0.119438f,
        0.311832f,
        0.889165f,
        -0.109012f,
        0.0629113f,
        0.430846f,
        -0.122383f,
        -0.244352f,
        0.442817f,
        0.225888f,
        -0.463381f,
        -0.00752805f,
        0.757519f,
        0.342279f,
        0.385499f,
        -0.148936f,
        0.0123484f,
        0.250187f,
        0.405487f,
        0.0526715f,
        0.583198f,
        -0.417668f,
        -0.378961f,
        0.209615f,
        0.969353f,
        0.0930797f,
        0.296234f,
        0.295574f,
        -0.357248f,
        -0.058679f,
        0.00665327f,
        0.654408f,
        0.57205f,
        0.284918f,
        0.16095f,
        0.452075f,
        0.664092f,
        0.349463f,
        0.235736f,
        -0.314015f,
        -0.604925f,
        0.378064f,
        0.22631f,
        0.126588f,
        0.653584f,
        0.0150895f,
        -0.555263f,
        0.382278f,
        0.106123f,
        0.215324f,
        -0.0708625f,
        0.792214f,
        -0.206288f,
        0.0786212f,
        0.0375045f,
        0.653835f,
        0.759247f,
        -0.50351f,
        -0.952774f,
        -0.641271f,
        -0.306879f,
        -0.366573f,
        0.668276f,
        0.112316f,
        0.781319f,
        0.0249539f,
        -0.450376f,
        0.326694f,
        -0.174106f,
        -0.00848852f,
        0.437573f,
        -0.260403f,
        -0.157757f,
        0.765958f,
        -0.28708f,
        0.248275f,
        0.197007f,
        -0.301496f,
        -0.623047f,
        -0.480562f,
        0.139266f,
        0.219111f,
        1.01969f,
        0.284622f,
        -0.327016f,
        -0.265801f,
        -0.776685f,
        0.150229f,
        0.64175f,
        -0.392648f,
        0.0872416f,
        -0.034698f,
        0.0921173f,
        0.233468f,
        -0.00165805f,
        0.0779562f,
        0.709687f,
        -0.669655f,
        0.0645248f,
        0.317402f,
        -0.513884f,
        -0.332851f,
        0.372274f,
        -0.0984483f,
        0.125253f,
        0.474523f,
        -0.429281f,
        -0.153329f,
        0.305789f,
        0.417951f,
        -0.131811f,
        0.337818f,
        0.0591731f,
        0.523637f,
        0.578502f,
        0.360708f,
        -0.32738f,
        -0.0729622f,
        0.451821f,
        0.64443f,
        0.651841f,
        0.769072f,
        0.618236f,
        -0.487449f,
        -0.371047f,
        0.18396f,
        -0.168264f,
        -0.568711f,
        -0.0710872f,
        -0.144531f,
        -0.584592f,
        0.258071f,
        -0.273004f,
        0.560677f,
        -0.102024f,
        -0.434248f,
        -0.0392282f,
        0.547041f,
        -0.239633f,
        -0.0598597f,
        -0.500522f,
        -0.627741f,
        0.329244f,
        0.22075f,
        -0.460037f,
        -0.550327f,
        0.630284f,
        0.754208f,
        0.204703f,
        -0.0600718f,
        -0.0250165f,
        -0.0949387f,
        0.476034f,
        -0.399513f,
        0.0214042f,
        0.00382778f,
        -0.725957f,
        -0.327294f,
        0.128471f,
        0.216118f,
        -0.376724f,
        0.439965f,
        0.427341f,
        -1.171f,
        0.0328693f,
        0.147638f,
        0.378832f,
        0.609612f,
        0.563242f,
        0.613791f,
        0.332825f,
        0.13229f,
        -0.133048f,
        -0.425763f,
        -0.38234f,
        0.384318f,
        0.297825f,
        -0.43632f,
        -0.629943f,
        -0.295298f,
        0.828788f,
        -0.481873f,
        0.364361f,
        0.0718396f,
        -0.0528269f,
        -0.51926f,
        -0.35529f,
        0.237619f,
        0.583832f,
        0.56783f,
        0.417471f,
        -0.240091f,
        0.467902f,
        0.0259747f,
        0.246304f,
        0.176301f,
        0.477683f,
        -0.118232f,
        0.329316f,
        0.0754236f,
        0.130923f,
        -0.137816f,
        0.83151f,
        0.517619f,
        0.439541f,
        0.179834f,
        0.0572086f,
        -0.171263f,
        0.0369111f,
        0.0944135f,
        0.350981f,
        -0.256415f,
        0.121307f,
        0.344493f,
        -0.123838f,
        0.0586727f,
        0.0639835f,
        -0.261158f,
        0.0362229f,
        -0.106367f,
        -0.461838f,
        0.215668f,
        0.366936f,
        -0.209888f,
        0.0725065f,
        0.0553085f,
        -0.711641f,
        -0.10678f,
        -0.279979f,
        0.597905f,
        0.279906f,
        0.132274f,
        -0.456124f,
        0.726561f,
        0.676879f,
        0.31727f,
        -1.05722f,
        0.0133673f,
        -0.300838f,
        -0.0137605f,
        0.268797f,
        0.150226f,
        0.905652f,
        -0.273401f,
        -0.156888f,
        -0.35032f,
        -0.705072f,
        0.115375f,
        -0.173964f,
        0.750607f,
        0.682817f,
        -0.423712f,
        0.0148758f,
        0.221006f,
        0.623754f,
        -0.229774f,
        4.0293f,
        -0.134639f,
        0.688204f,
        0.601418f,
        -0.130248f,
        -0.00831524f,
        0.710796f,
        -0.159471f,
        0.427394f,
        0.121077f,
        0.370558f,
        0.430744f,
        -0.143746f,
        -0.0292179f,
        0.0899888f,
        0.0842556f,
        0.929766f,
        -0.0508189f,
        0.260067f,
        0.312874f,
        -0.391206f,
        0.182903f,
        0.129737f,
        -0.575612f,
        0.549913f,
        0.2174f,
        0.070329f,
        0.505656f,
        -0.0235075f,
        0.343921f,
        0.497662f,
        0.64236f,
        0.139685f,
        0.613977f,
        0.0883534f,
        0.551976f,
        0.179921f,
        -0.0713425f,
        0.188083f,
        0.411966f,
        -0.7543f,
        0.0830188f,
        -0.303479f,
        0.411361f,
        0.252781f,
        -0.53519f,
        0.563046f,
        0.134353f,
        0.857542f,
        -0.375826f,
        0.0274122f,
        -0.157338f,
        -0.698082f,
        0.183708f,
        -0.0019827f,
        0.469519f,
        0.0999717f,
        0.717229f,
        0.549638f,
        -0.45518f,
        -0.215521f,
        -0.288151f,
        0.128363f,
        0.37515f,
        -0.228876f,
        0.153987f,
        0.183421f,
        0.642641f,
        0.46803f,
        -0.303872f,
        0.274705f,
        0.628131f,
        0.170106f,
        -0.161889f,
        0.0512407f,
        -0.510444f,
        0.154117f,
        -0.180786f,
        0.0367793f,
        -0.338875f,
        0.818837f,
        -0.394681f,
        -0.138623f,
        -0.0827224f,
        -0.239294f,
        0.541183f,
        -0.299256f,
        -0.619387f,
        0.651301f,
        0.134007f,
        0.523502f,
        -0.133847f,
        0.25037f,
        0.160561f,
        0.793139f,
        0.203346f,
        0.549613f,
        -3.47911f,
        0.182043f,
        0.0428072f,
        0.312649f,
        0.136966f,
        0.38647f,
        0.294093f,
        0.545893f,
        -0.125142f,
        -0.307674f,
        0.0798822f,
        0.125098f,
        -0.0770192f,
        0.698268f,
        0.142271f,
        0.303732f,
        0.0531643f,
        0.439754f,
        0.331f,
        -0.214821f,
        -0.783514f,
        0.836403f,
        0.251499f,
        -0.275832f,
        -0.0945489f,
        -0.367872f,
        -0.203037f,
        -0.202611f,
        -0.574907f,
        0.323074f,
        -0.0560598f,
        -0.0704381f,
        0.730039f,
        -0.00326889f,
        -0.120521f,
        0.379592f,
        0.487894f,
        0.353686f,
        -0.261049f,
        0.277122f,
        -0.201591f,
        1.10181f,
        0.255922f,
        -0.319775f,
        0.415599f,
        -0.607293f,
        -0.378761f,
        0.602727f,
        0.223509f,
        0.157216f,
        0.189135f,
        0.290214f,
        0.27202f,
        0.288698f,
        0.549082f,
        -0.646762f,
        -0.259452f,
        0.235991f,
        0.561285f,
        0.540321f,
        -0.324089f,
        0.400494f,
        0.348743f,
        -0.0463721f,
        -0.150454f,
        -0.400076f,
        0.876328f,
        0.121883f,
        0.456826f,
        0.164917f,
        -0.358911f,
        -0.0182833f,
        0.550138f,
        -0.487604f,
        0.160502f,
        -0.106156f,
        -0.108933f,
        -0.483079f,
        0.115765f,
        -0.239835f,
        -0.123674f,
        -0.0772104f,
        -0.586845f,
        0.309276f,
        2.89442f,
        0.369895f,
        2.19058f,
        0.506834f,
        -0.235926f,
        -0.0110605f,
        -0.561959f,
        0.651568f,
        -0.129606f,
        0.22218f,
        -0.00408447f,
        0.198403f,
        -0.117113f,
        0.169789f,
        0.309042f,
        -0.125793f,
        0.580178f,
        -0.953796f,
        0.135533f,
        -0.199693f,
        0.168325f,
        -0.326407f,
        -0.360984f,
        0.318424f,
        0.318263f,
        -0.35932f,
        -0.0824758f,
        0.294698f,
        0.380105f,
        0.163586f,
        0.0993546f,
        0.513933f,
        -0.215886f,
        -0.39031f,
        -0.0763231f,
        0.0255306f,
        0.117816f,
        4.28046f,
        -0.0392324f,
        -0.483825f,
        -0.0830668f,
        -0.0404579f,
        -0.00775028f,
        0.486643f,
        -0.150555f,
        -0.215355f,
        -0.219273f,
        0.301666f,
        0.751653f,
        0.50515f,
        0.382473f,
        -0.276552f,
        0.0758052f,
        0.310505f,
        -0.047366f,
        0.598082f,
        0.317825f,
        0.457877f,
        -0.275882f,
        0.204522f,
        0.205572f,
        0.0860192f,
        0.0672689f,
        0.123075f,
        -0.345067f,
        -0.058266f,
        0.600544f,
        0.176824f,
        4.99254f,
        -0.261395f,
        -0.282299f,
        -0.543572f,
        -0.326677f,
        0.389048f,
        0.495831f,
        0.159641f,
        -0.220304f,
        0.0755756f,
        -0.190079f,
        -0.484991f,
        -0.406161f,
        0.127138f,
        -0.0469593f,
        -0.0878678f,
        -0.280627f,
        -0.335037f,
        0.577379f,
        -0.750762f,
        0.465078f,
        0.475708f,
        0.19251f,
        -0.368443f,
        0.136698f,
        -0.004451f,
        0.0402144f,
        -0.431164f,
        -0.308172f,
        0.864042f,
        0.0321429f,
        0.886648f,
        -0.142884f,
        0.626751f,
        -0.0733132f,
        -0.191346f,
        0.556155f,
        0.0304968f,
        0.0534245f,
        -0.481105f,
        0.396001f,
        0.454669f,
        -0.207558f,
        -0.347488f,
        -0.642431f,
        0.161536f,
        0.114317f,
        -0.143409f,
        -0.187024f,
        -0.00382934f,
        -0.537457f,
        -0.120625f,
        0.631947f,
        0.532969f,
        0.93896f,
        0.237261f,
        0.389407f,
        -0.338147f,
        -0.309161f,
        -0.0731f,
        0.836306f,
        0.225679f,
        -0.132609f,
        0.560104f,
        0.568387f,
        0.174715f,
        0.636857f,
        0.245331f,
        0.123538f,
        0.0385534f,
        -0.13516f,
        0.116054f,
        0.319137f,
        -0.159883f,
        0.0845947f,
        0.352338f,
        -0.199956f,
        -0.199644f,
        0.549502f,
        -0.184039f,
        -0.138025f,
        -0.311579f,
        -0.414554f,
        -0.189855f,
        0.227686f,
        0.319739f,
        0.00294587f,
        -0.121248f,
        -0.249631f,
        0.226842f,
        -0.020929f,
        0.536802f,
        -0.0575349f,
        0.236443f,
        0.100405f,
        -0.0827088f,
        0.0594563f,
        -0.412699f,
        0.0182124f,
        0.431099f,
        -0.651148f,
        0.547231f,
        -0.385679f,
        0.0219657f,
        0.173251f,
        -0.530588f,
        0.08831f,
        -0.259678f,
        0.262893f,
        -0.0383076f,
        0.42867f,
        -0.00203917f,
        0.0486499f,
        -0.0209091f,
        -0.0194265f };

    private static final float[] LAST_VECTOR = new float[] {
        -0.266342f,
        0.0564342f,
        0.0502874f,
        -0.00832321f,
        0.144532f,
        0.848801f,
        0.6351f,
        -0.25363f,
        -0.234874f,
        0.592435f,
        -1.14723f,
        -0.433436f,
        -0.0903844f,
        0.324454f,
        0.365541f,
        0.392914f,
        0.233802f,
        0.426691f,
        -0.148732f,
        0.0142508f,
        -0.355311f,
        0.746514f,
        0.265318f,
        0.425146f,
        -0.146786f,
        0.845986f,
        -0.358056f,
        0.226953f,
        -0.0126942f,
        -0.172719f,
        0.705671f,
        -0.388727f,
        -0.369467f,
        0.391855f,
        0.300777f,
        0.575755f,
        0.0114235f,
        0.260862f,
        -0.0839479f,
        0.43634f,
        -0.689945f,
        -0.698351f,
        0.955444f,
        0.302984f,
        0.407936f,
        0.276527f,
        0.160782f,
        -0.0583437f,
        0.374797f,
        0.0992836f,
        -0.482215f,
        -0.184132f,
        -0.136763f,
        0.401546f,
        -0.973311f,
        0.171587f,
        -0.354883f,
        0.315324f,
        -0.0050452f,
        -0.669069f,
        0.41696f,
        0.101236f,
        -0.0890117f,
        -0.184406f,
        -0.0340359f,
        0.371647f,
        0.349085f,
        0.409236f,
        0.0833822f,
        -0.211436f,
        -0.0212483f,
        0.391928f,
        -0.258231f,
        -0.238419f,
        -0.395321f,
        -0.337464f,
        -0.316459f,
        0.20382f,
        0.837426f,
        0.0392804f,
        0.955361f,
        -0.472843f,
        -0.509387f,
        0.471745f,
        0.932914f,
        0.345327f,
        0.194766f,
        0.397774f,
        0.51689f,
        0.410926f,
        -0.505832f,
        0.388943f,
        0.365984f,
        0.197923f,
        0.842557f,
        -0.414724f,
        -0.0250909f,
        -0.51378f,
        -0.0669748f,
        -0.831481f,
        0.254662f,
        -0.313861f,
        -0.504228f,
        -0.00325349f,
        0.128714f,
        -0.205963f,
        -0.468127f,
        -0.594391f,
        0.11184f,
        -0.124489f,
        1.3817f,
        0.0301596f,
        -0.169105f,
        -0.185308f,
        0.213637f,
        0.125682f,
        0.38492f,
        -0.43268f,
        -0.433045f,
        -1.29399f,
        0.858604f,
        0.457928f,
        -0.351907f,
        -0.73271f,
        -0.0344893f,
        -0.50271f,
        0.386747f,
        -0.258653f,
        0.550873f,
        0.0245975f,
        0.104093f,
        -0.225543f,
        -0.677999f,
        1.04298f,
        0.0957196f,
        -0.0583004f,
        0.273178f,
        0.0343422f,
        -0.363223f,
        -0.189446f,
        -0.000502067f,
        0.813783f,
        0.361597f,
        0.308508f,
        -0.593759f,
        0.46855f,
        -0.101405f,
        0.280198f,
        0.354548f,
        0.115865f,
        0.108269f,
        0.0590735f,
        0.301485f,
        0.261545f,
        0.530583f,
        -0.379434f,
        -0.165781f,
        0.197607f,
        0.045061f,
        0.131865f,
        0.640353f,
        0.398034f,
        0.909199f,
        -0.0481894f,
        0.152462f,
        0.480988f,
        0.19413f,
        1.13526f,
        0.327421f,
        -0.310109f,
        -0.793656f,
        -0.408606f,
        1.12104f,
        -0.166011f,
        0.0942666f,
        0.692426f,
        0.137395f,
        0.50734f,
        0.353194f,
        0.471988f,
        -0.116953f,
        0.0361236f,
        0.698542f,
        0.165693f,
        0.862439f,
        0.145611f,
        0.356722f,
        -0.171139f,
        -0.115183f,
        0.046654f,
        0.322002f,
        0.0342879f,
        0.789146f,
        0.364574f,
        -0.598335f,
        -0.0478167f,
        0.479835f,
        1.03413f,
        -0.730121f,
        0.521367f,
        0.181633f,
        0.153007f,
        -0.238541f,
        0.458681f,
        0.942721f,
        -0.285682f,
        -0.20117f,
        -0.274579f,
        -0.144839f,
        -0.161062f,
        0.610353f,
        0.191385f,
        0.0472619f,
        0.236336f,
        -0.417002f,
        -0.0239151f,
        0.403804f,
        0.430197f,
        0.339747f,
        -0.0438874f,
        0.120789f,
        0.426828f,
        -0.0545759f,
        0.0555526f,
        -0.0812449f,
        -0.0900145f,
        -0.314296f,
        -0.256046f,
        0.348851f,
        0.0220501f,
        1.12347f,
        -0.840341f,
        0.436465f,
        -0.145464f,
        0.0914117f,
        -0.169142f,
        0.69214f,
        -0.0828993f,
        -0.710458f,
        0.205463f,
        0.823056f,
        0.254264f,
        0.0824363f,
        0.286319f,
        0.299703f,
        -0.93219f,
        0.130317f,
        -0.78339f,
        -0.318324f,
        -0.261726f,
        0.277249f,
        -0.312271f,
        -0.412415f,
        0.0781794f,
        0.203932f,
        -0.332704f,
        0.373891f,
        -0.0855449f,
        0.00371282f,
        -0.31987f,
        0.591491f,
        -0.667578f,
        0.689376f,
        0.78245f,
        -0.327517f,
        -0.106984f,
        0.66767f,
        0.749219f,
        0.0932298f,
        0.891932f,
        0.808384f,
        0.0337952f,
        -0.391596f,
        0.145414f,
        0.229257f,
        -0.965453f,
        0.0742275f,
        -0.369302f,
        -0.0566969f,
        0.458736f,
        -0.0499464f,
        -0.232805f,
        -0.22723f,
        0.109128f,
        0.360013f,
        0.68726f,
        -0.0628058f,
        -0.457685f,
        -0.425676f,
        0.774979f,
        -0.070843f,
        0.490336f,
        -0.146933f,
        -0.0820729f,
        -0.236183f,
        0.507045f,
        0.420998f,
        -0.498834f,
        0.613545f,
        0.479039f,
        0.653325f,
        -0.181386f,
        0.266984f,
        0.0834408f,
        0.159883f,
        -0.53243f,
        -0.668667f,
        -0.358709f,
        -0.502087f,
        -0.211816f,
        0.265246f,
        -0.648509f,
        -0.366079f,
        0.165437f,
        -0.12006f,
        0.73208f,
        0.0946367f,
        -0.0397022f,
        0.373222f,
        0.769802f,
        -0.372603f,
        -0.247053f,
        -0.0613943f,
        0.882295f,
        0.871014f,
        -0.533935f,
        0.393421f,
        0.00475235f,
        0.799607f,
        -0.466778f,
        0.508871f,
        0.0916714f,
        -0.236513f,
        -0.0531898f,
        0.120464f,
        0.323541f,
        -0.0664127f,
        0.411727f,
        0.159663f,
        -0.389783f,
        0.432521f,
        -0.275003f,
        0.430512f,
        0.0740006f,
        -0.286203f,
        -0.0561935f,
        0.217662f,
        -0.389667f,
        0.450201f,
        -0.107107f,
        0.205033f,
        0.0358203f,
        -0.070628f,
        -0.386132f,
        0.347096f,
        -0.0975492f,
        -0.0741379f,
        0.552051f,
        0.527328f,
        -0.330402f,
        0.0128324f,
        0.469999f,
        0.25383f,
        -0.0443425f,
        0.0162323f,
        -0.455896f,
        -0.398029f,
        0.587222f,
        0.417165f,
        0.150405f,
        -0.452327f,
        -0.246961f,
        0.487518f,
        0.120036f,
        -0.267235f,
        -0.147599f,
        -0.744583f,
        0.508843f,
        0.51711f,
        -0.281998f,
        0.0611944f,
        0.820149f,
        0.0543506f,
        -0.0691932f,
        -0.386042f,
        0.032668f,
        -0.675483f,
        -0.726395f,
        0.0259413f,
        -0.531229f,
        -0.178907f,
        -0.0672937f,
        0.30893f,
        0.195385f,
        -0.196026f,
        -0.0226268f,
        -0.470597f,
        1.22566f,
        0.764648f,
        -0.0997848f,
        -0.500588f,
        0.234752f,
        0.0450825f,
        0.487306f,
        3.79623f,
        -0.241075f,
        -0.314962f,
        0.412451f,
        0.303548f,
        -0.515862f,
        0.372009f,
        -0.766511f,
        -0.126009f,
        0.0832119f,
        0.193364f,
        0.236886f,
        0.0848833f,
        0.484799f,
        -0.0549393f,
        -0.543025f,
        1.08118f,
        0.149157f,
        -0.217352f,
        -0.176795f,
        -0.169759f,
        0.865729f,
        0.32061f,
        -0.295987f,
        1.00787f,
        0.2866f,
        -0.16918f,
        0.0833091f,
        0.597402f,
        0.584203f,
        0.871086f,
        -0.125107f,
        -0.083002f,
        -0.0744018f,
        -0.475623f,
        0.839214f,
        -0.239293f,
        0.312221f,
        0.477299f,
        0.242539f,
        -0.0386981f,
        0.172693f,
        0.572695f,
        0.499376f,
        0.859176f,
        -0.738552f,
        0.7061f,
        0.325071f,
        0.16908f,
        0.185541f,
        -0.210598f,
        0.0142842f,
        -0.794521f,
        0.252458f,
        0.0656578f,
        0.59963f,
        0.176528f,
        0.43515f,
        0.559442f,
        0.260334f,
        -0.273232f,
        -0.328987f,
        -0.041823f,
        -0.208377f,
        0.00909583f,
        0.671478f,
        -0.0270444f,
        0.597089f,
        -0.294711f,
        -0.11497f,
        0.421688f,
        0.452158f,
        0.359413f,
        0.378132f,
        0.149345f,
        -0.156667f,
        -0.146184f,
        0.0766334f,
        -0.840292f,
        0.388336f,
        1.23639f,
        -0.281615f,
        -0.418839f,
        0.0226898f,
        -0.571094f,
        0.612228f,
        -0.0409158f,
        -0.234f,
        0.53775f,
        0.18673f,
        0.343246f,
        0.213543f,
        0.283354f,
        0.594809f,
        0.792437f,
        0.688786f,
        -0.10831f,
        -3.43048f,
        0.0703365f,
        0.706451f,
        0.106714f,
        -0.130016f,
        0.0159349f,
        0.730971f,
        0.0707707f,
        -0.294018f,
        -0.0327343f,
        -0.97382f,
        0.0476975f,
        0.157941f,
        -0.282283f,
        -0.410216f,
        0.0713643f,
        -0.0803789f,
        0.175135f,
        0.0638149f,
        -0.367479f,
        -0.151583f,
        0.529756f,
        0.144789f,
        -0.128141f,
        0.49074f,
        -0.260097f,
        0.0350283f,
        -0.352315f,
        -0.763654f,
        -0.352189f,
        -0.0947639f,
        -0.210412f,
        0.631139f,
        -0.0961724f,
        0.948349f,
        0.0346557f,
        -0.467683f,
        -0.250371f,
        -0.251391f,
        0.414847f,
        0.0274715f,
        0.60487f,
        0.0759062f,
        0.311347f,
        0.610531f,
        -0.594121f,
        0.121912f,
        -0.0523956f,
        0.133897f,
        0.35339f,
        -0.098903f,
        -0.045762f,
        0.0207694f,
        -0.182167f,
        0.906914f,
        -0.330716f,
        -0.289249f,
        0.331587f,
        1.05856f,
        0.461383f,
        -0.569953f,
        -0.321833f,
        0.106508f,
        0.125612f,
        -0.230687f,
        -0.18482f,
        0.052791f,
        -0.254949f,
        -0.506002f,
        -0.406307f,
        0.260129f,
        0.317818f,
        0.0418458f,
        -0.0242655f,
        0.254182f,
        -0.169113f,
        0.430973f,
        -0.266401f,
        0.0914543f,
        -0.188475f,
        0.127496f,
        0.247603f,
        -0.559284f,
        -0.0199304f,
        3.00977f,
        0.472541f,
        2.23615f,
        -0.693895f,
        -0.0731271f,
        -0.347707f,
        -0.991991f,
        0.0604774f,
        -0.0756665f,
        -0.0417459f,
        0.34459f,
        0.109613f,
        -0.401599f,
        -0.133066f,
        0.292868f,
        -0.0865824f,
        0.330074f,
        -1.0162f,
        -0.476332f,
        0.534537f,
        0.00712591f,
        -0.774217f,
        -0.0471908f,
        -0.0519747f,
        0.522708f,
        -0.234809f,
        0.553614f,
        0.0774443f,
        -0.228599f,
        -0.0486339f,
        0.00677573f,
        0.677708f,
        -0.112454f,
        -0.0641543f,
        0.782425f,
        0.710775f,
        -0.0354235f,
        4.16755f,
        0.524858f,
        -0.602709f,
        0.502461f,
        0.337074f,
        0.0969543f,
        1.12011f,
        0.178123f,
        0.657115f,
        0.693177f,
        0.200627f,
        -0.161638f,
        0.0352974f,
        0.276949f,
        0.547769f,
        0.360205f,
        0.753637f,
        0.399222f,
        0.877773f,
        0.189825f,
        0.747029f,
        -0.454778f,
        0.750466f,
        -0.27787f,
        0.0469348f,
        0.794469f,
        -0.466412f,
        -0.518201f,
        -0.231003f,
        0.42324f,
        -0.201703f,
        4.77595f,
        -0.0851908f,
        -0.263314f,
        -0.113185f,
        0.068105f,
        -0.148184f,
        0.33448f,
        0.786864f,
        -0.584935f,
        0.0734639f,
        -0.294355f,
        -0.454415f,
        -0.479698f,
        0.43547f,
        0.0737978f,
        0.673096f,
        -0.160867f,
        -0.00169898f,
        0.617483f,
        -0.0570049f,
        0.827458f,
        -0.602797f,
        -0.0945726f,
        -0.917663f,
        0.170431f,
        0.336913f,
        -0.268182f,
        0.53693f,
        -0.203867f,
        -0.0251039f,
        0.205181f,
        1.12883f,
        -0.398524f,
        0.496936f,
        -0.564851f,
        0.0543884f,
        0.12318f,
        0.170287f,
        0.60315f,
        -0.525827f,
        0.786647f,
        0.560062f,
        -0.373942f,
        -0.546536f,
        0.63401f,
        0.252705f,
        -0.239989f,
        -0.0219945f,
        -0.510503f,
        0.257002f,
        -0.427062f,
        -0.107706f,
        0.872549f,
        -0.343238f,
        0.765731f,
        -0.0462846f,
        0.177147f,
        0.300698f,
        -0.903105f,
        -0.097981f,
        0.613372f,
        0.196947f,
        0.380656f,
        0.353099f,
        0.258819f,
        -0.521806f,
        0.78225f,
        0.203129f,
        0.0730129f,
        -0.382695f,
        -0.442597f,
        -0.301081f,
        0.764998f,
        0.941454f,
        -0.233907f,
        -0.120475f,
        1.1396f,
        -0.317932f,
        -0.067318f,
        -0.944421f,
        0.353293f,
        -1.16241f,
        -0.146326f,
        0.146059f,
        0.0471397f,
        0.0401596f,
        0.361254f,
        0.223301f,
        -0.0488712f,
        0.593441f,
        -0.164095f,
        0.150768f,
        -0.220334f,
        0.49888f,
        0.233286f,
        0.517547f,
        0.4403f,
        -0.0750423f,
        -0.101841f,
        0.149676f,
        -0.128053f,
        0.506729f,
        0.0499696f,
        -0.0463808f,
        0.256271f,
        -0.674182f,
        0.384412f,
        -0.184287f,
        0.207903f,
        -0.117686f,
        0.64126f,
        0.0946028f,
        0.632547f,
        -0.442378f,
        -0.688082f };
}
